<div class="ccs-weakness-templates p-2">
  <button type="button" data-action="add">Add Template</button>
  <hr/>
  <table style="width:100%;">
    <thead>
      <tr>
        <th>Label</th>
        <th>Trigger Kind</th>
        <th>Key/Trait</th>
        <th>Effect</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {{#each templates as |w|}}
      <tr>
        <td>
          <input type="text"
                 value="{{w.label}}"
                 data-id="{{w.id}}"
                 data-field="label"
                 title="Display name for this weakness template (GM-facing only)."/>
        </td>
        <td>
          <select data-id="{{w.id}}"
                  data-field="trigger.kind"
                  title="Which type of stunt must match to trigger this weakness.">
            {{#select w.trigger.kind}}
              <option value="attack"    title="Stunts treated as attacks (e.g., strike-like stunts).">attack</option>
              <option value="skill"     title="Skill-based stunts (e.g., Athletics, Acrobatics).">skill</option>
              <option value="spell"     title="Spell attack stunts (use key 'spell-attack' to match).">spell</option>
              <option value="trait"     title="Match by a stunt trait (e.g., 'visual', 'trip').">trait</option>
              <option value="condition" title="Match by a condition tag already on the stunt (e.g., 'frightened').">condition</option>
            {{/select}}
          </select>
        </td>
        <td>
          <input type="text"
                 value="{{w.trigger.key}}"
                 placeholder="key"
                 data-id="{{w.id}}"
                 data-field="trigger.key"
                 title="Optional. For skill: use the skill slug (e.g., 'athletics'). For spell: 'spell-attack'. For condition: the condition slug. Leave empty if using trait-only."/>
          <input type="text"
                 value="{{w.trigger.trait}}"
                 placeholder="trait"
                 data-id="{{w.id}}"
                 data-field="trigger.trait"
                 title="Optional trait filter for attack/trait kinds (e.g., 'visual', 'trip'). Leave empty if not needed."/>
        </td>
        <td>
          <select data-id="{{w.id}}"
                  data-field="effect.type"
                  title="What happens when the weakness triggers.">
            {{#select w.effect.type}}
              <option value="apply-condition" title="Applies a PF2e condition to the target (value = condition slug, e.g., 'dazzled').">apply-condition</option>
              <option value="degree-bump"     title="Shifts degree of success by +N (value = number). Capped at crit.">degree-bump</option>
            {{/select}}
          </select>
          <input type="text"
                 value="{{w.effect.value}}"
                 placeholder="value"
                 data-id="{{w.id}}"
                 data-field="effect.value"
                 title="For apply-condition: condition slug (e.g., 'dazzled'). For degree-bump: a number (e.g., 1)."/>
        </td>
        <td><button type="button" data-action="delete" data-id="{{w.id}}" title="Delete this template">ðŸ—‘</button></td>
      </tr>
      {{/each}}
    </tbody>
  </table>
</div>